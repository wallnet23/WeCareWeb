<form [formGroup]="stepInverterForm">
  <mat-card>
    <mat-card-header class="titleBorder bg-primary bg-opacity-25">
      <mat-card-title style="font-weight: bold;">{{ "SYSTEM.STEPFOUR.INVERTER.INVERTERINFO" | translate}}</mat-card-title>
    </mat-card-header>
    <mat-card-content class="px-1 p-md-2">
      <div class="col-12 form-check form-switch mt-4">
        <input class="form-check-input" type="checkbox" role="switch" id="inverter_hybrid"
          formControlName="inverter_hybrid">
        <label class="form-check-label" for="inverter_hybrid">{{ "SYSTEM.STEPFOUR.INVERTER.HYBRIDINVERTER" | translate}}</label>
      </div>
      <div class="col-12 form-check form-switch mt-4">
        <input class="form-check-input" type="checkbox" role="switch" id="inverter_online"
          formControlName="inverter_online">
        <label class="form-check-label" for="inverter_online">{{ "SYSTEM.STEPFOUR.INVERTER.ONLINEINVERTER" | translate}}?</label>
        <div class="fst-italic fw-bold text-danger" *ngIf="stepInverterForm.get('inverter_online')?.value != 1">
          {{ "SYSTEM.STEPFOUR.INVERTER.ONLINEERROR" | translate}}!
        </div>
      </div>
      <div class="col-12 col-lg-4 mt-3 p-0">
        <label for="inverter_number" style="font-weight: bold; font-size: medium;">
          {{ "SYSTEM.STEPFOUR.INVERTER.INVERTERNUMBER" | translate}}
          <mat-icon matTooltip="{{'SYSTEM.STEPFOUR.INVERTER.QUANTITY' | translate}}"
            style="font-size: medium;">info</mat-icon>
        </label>
        <select class="form-select" formControlName="inverter_number" id="inverter_number">
          <option [ngValue]="null">{{ "SYSTEM.STEPFOUR.INVERTER.SELECTVALUE" | translate}}</option>
          <option *ngFor="let number of numInverter" [ngValue]="number.num"> {{number.num}}
          </option>
        </select>
      </div>

      <div class="col-12 mt-3 form-check form-switch" *ngIf="stepInverterForm.get('inverter_number')?.value != null &&
      stepInverterForm.get('inverter_number')?.value != undefined &&
      stepInverterForm.get('inverter_number')?.value != 1">
        <input class="form-check-input" type="checkbox" role="switch" id="inverter_communication"
          formControlName="inverter_communication">
        <label class="form-check-label" for="inverter_communication">
          {{ "SYSTEM.STEPFOUR.INVERTER.PARALLELCOMUNICATION" | translate}}
        </label>
      </div>

      <div class="col-12 mt-3 form-check form-switch" *ngIf="stepInverterForm.get('inverter_number')?.value != null &&
      stepInverterForm.get('inverter_number')?.value != undefined &&
      stepInverterForm.get('inverter_number')?.value != 1">
        <input class="form-check-input" type="checkbox" role="switch" id="inverter_power"
          formControlName="inverter_power">
        <label class="form-check-label" for="inverter_power">
          {{ "SYSTEM.STEPFOUR.INVERTER.PARALLELPOWER" | translate}}
        </label>
      </div>

      <div class="col-12 p-0 mt-3" *ngIf="stepInverterForm.get('inverter_number')?.value != null">
        <div class="container">
          <div class="row mt-1">
            <div class="col-12 col-md-6 col-lg-4 col-xxl-4 px-0 px-md-2 mb-2"
              *ngFor="let formGroup of inverterFieldAsFormArray.controls; let i = index" formArrayName="inverters_list">
              <mat-card>
                <div [formGroupName]="i">
                  <mat-card-header style="border-bottom: 2px solid lightgray;" class="bg-primary bg-opacity-10">
                    <mat-card-title style="font-weight: bold; font-size: medium;">
                      {{ "SYSTEM.STEPFOUR.INVERTER.INVERTER" | translate}} {{i+1}}</mat-card-title>
                  </mat-card-header>
                  <mat-card-content class="pb-2 pl-0 pr-0">
                    <div class="container-fluid">
                      <div class="row">
                        <div class="col-12">
                          <label class="mt-2" style="font-weight: bold; font-size: medium;">
                            {{ "SYSTEM.STEPFOUR.INVERTER.SERIALNUMBER" | translate}}
                          </label>
                        </div>
                        <div class="col-12">
                          <input class="form-control" type="text" formControlName="serialnumber"
                            (change)="releaseUpdateListInverters()">
                          <app-scanner-selector class="cameraIcon"
                            (barcodeScanned)="onBarcodeScanned($event, i)"></app-scanner-selector>
                        </div>

                        <div class="col-12">
                          <label class="mt-2" style="font-weight: bold; font-size: medium;">{{ "SYSTEM.STEPFOUR.INVERTER.MODEL" | translate}}</label>
                          <input class="form-control" type="text" formControlName="model">
                        </div>

                      </div>
                    </div>
                  </mat-card-content>
                </div>
              </mat-card>
            </div>
          </div>
        </div>
      </div>
    </mat-card-content>
  </mat-card>
</form>
