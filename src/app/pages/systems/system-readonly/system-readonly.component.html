<div class="arrowBtn d-none d-sm-inline">
    <a (click)="goBack()" class="btn btn-outline-dark">
        <i class="bi bi-arrow-left arrowIcon"></i>
    </a>
</div>

<div *ngIf="idsystem > 0; else blockError;" class="container fullPage p-2 p-md-3 p-lg-4" style="min-width: 350px;">
    <div class="row justify-content-center align-items-center mt-4">
        <div class="col-12 text-center" style="font-size: xx-large; font-weight: bold;">
            <span class="inline-bordered">
                {{systemInfo.stepOne!.system_name}}
            </span>
        </div>
    </div>

    <div class="row justify-content-center align-items-center mt-2 p-md-1 p-lg-2 p-xl-3">
        <div class="col-12 fst-italic text-center">
            {{systemInfo.stepOne!.system_description}}
        </div>
    </div>

    <div class="row">
        <div class="col-12 mb-3 title">
           {{"SYSTEM.READONLY.OWNER" | translate}}
        </div>
    </div>
    <div class="row">
        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
            <span class="subtitles me-5">{{"SYSTEM.READONLY.NAME" | translate}}: </span>
            <p class="content">{{systemInfo.stepOne!.customer_name}}</p>
        </div>
        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
            <span class="subtitles me-5">{{"SYSTEM.READONLY.SURNAME" | translate}}: </span>
            <p class="content">{{systemInfo.stepOne!.customer_surname}}</p>
        </div>
        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
            <span class="subtitles me-5">{{"SYSTEM.READONLY.PHONE" | translate}}: </span>
            <p class="content">{{systemInfo.stepOne!.customer_phone}}</p>
        </div>
        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
            <span class="subtitles me-5">{{"SYSTEM.READONLY.COUNTRY" | translate}}: </span>
            <p class="content">{{customerCountry}}</p>
        </div>
        <div *ngIf="systemInfo?.stepOne?.ccn3 !== '380'; else italianBlock">
            <div class="col-6 col-md-4 col-lg-3 col-xl-2">
                <span class="subtitles me-5">{{"SYSTEM.READONLY.LICENSENUMBER" | translate}}: </span>
                <p class="content">{{systemInfo.stepOne!.customer_licensenumber}}</p>
            </div>
        </div>
        <ng-template #italianBlock>
            <div class="col-6 col-md-4 col-lg-3 col-xl-2">
                <span class="subtitles me-5">{{"SYSTEM.READONLY.FISCALCODE" | translate}}: </span>
                <p class="content">{{systemInfo.stepOne!.customer_fiscalcode}}</p>
            </div>
            <div class="col-6 col-md-4 col-lg-3 col-xl-2">
                <span class="subtitles me-5">{{"SYSTEM.READONLY.VAT" | translate}}: </span>
                <p class="content">{{systemInfo.stepOne!.customer_vat}}</p>
            </div>
        </ng-template>
    </div>

    <div class="row">
        <div class="col-12 mb-3 title">
            {{"SYSTEM.READONLY.INSTALLERINFO" | translate}}
        </div>
    </div>
    <div class="row">
        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
            <span class="subtitles">{{"SYSTEM.READONLY.COMPANYNAME" | translate}}: </span>
            <p class="content">{{systemInfo.stepThree!.installer_companyname}}</p>
        </div>
        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
            <span class="subtitles">{{"SYSTEM.READONLY.COUNTRY" | translate}}: </span>
            <p class="content">{{installerCountry}}</p>
        </div>
        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
            <span class="subtitles">{{"SYSTEM.READONLY.ADDRESS" | translate}}: </span>
            <p class="content">{{systemInfo.stepThree!.installer_address}}</p>
        </div>
        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
            <span class="subtitles">{{"SYSTEM.READONLY.DATEOFPURCHASE" | translate}}: </span>
            <p class="content">{{systemInfo.stepThree!.installer_dateofpurchase}}</p>
        </div>
        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
            <span class="subtitles">{{"SYSTEM.READONLY.VENDORCONTACT" | translate}}: </span>
            <p class="content">{{systemInfo.stepThree!.vendor_contact}}</p>
        </div>
        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
            <span class="subtitles">{{"SYSTEM.READONLY.EMAIL" | translate}}: </span>
            <p class="content">{{systemInfo.stepThree!.installer_email}}</p>
        </div>

        <div *ngIf="imagesStep3.length > 0" class="col-12 mb-2 text-center">
            <span class="subtitles">{{"SYSTEM.READONLY.ATTACHEDFILES" | translate}}</span>
        </div>

        <div class="container-fluid">
            <div class="row justify-content-center align-items-center mt-4">
                <ng-container *ngFor="let image3 of imagesStep3">
                    <div class="col-6 col-md-2 mb-4 text-center" style="width: 100px; height: 100px;">
                        <img [src]="urlServerLara + image3.src" [alt]="image3.title" class="img-fluid thumbnailImg"
                        (click)="setImage(image3)" data-bs-toggle="modal" data-bs-target="#exampleModal">
                    </div>
                </ng-container>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-12 mb-3 title">
            {{"SYSTEM.READONLY.INSTALLATIONSITE" | translate}}
        </div>
        <div class="row">
            <div class="col-6 col-lg-3">
                <span class="subtitles">{{"SYSTEM.READONLY.COUNTRY" | translate}}: </span>
                <p class="content">{{installerCountry}}</p>
            </div>
            <div class="col-6 col-lg-3">
                <span class="subtitles">{{"SYSTEM.READONLY.ADDRESS" | translate}}: </span>
                <p class="content">{{systemInfo.stepTwo!.location_address}}</p>
            </div>
            <div class="col-6 col-lg-3">
                <span class="subtitles">{{"SYSTEM.READONLY.CITY" | translate}}: </span>
                <p class="content">{{systemInfo.stepTwo!.location_city}}</p>
            </div>
            <div class="col-6 col-lg-3">
                <span class="subtitles">{{"SYSTEM.READONLY.POSTALCODE" | translate}}: </span>
                <p class="content">{{systemInfo.stepTwo!.location_postalcode}}</p>
            </div>

            <div *ngIf="imagesStep2.length > 0" class="col-12 mb-2 text-center">
                <span class="subtitles">{{"SYSTEM.READONLY.ATTACHEDFILES" | translate}}</span>
            </div>

            <div class="container-fluid">
                <div class="row justify-content-center align-items-center mt-4">
                    <ng-container *ngFor="let image2 of imagesStep2">
                        <div class="col-6 col-md-2 mb-4 text-center" style="width: 100px; height: 100px;">
                            <img [src]="urlServerLara + image2.src" [alt]="image2.title" class="img-fluid thumbnailImg"
                                (click)="setImage(image2)" data-bs-toggle="modal" data-bs-target="#exampleModal">
                        </div>
                    </ng-container>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-12 mb-3 title">
            {{"SYSTEM.READONLY.PRODUCTINFO" | translate}}
        </div>
    </div>
    <div class="row">
        <div class="col-6 col-md-4 col-lg-3">
            <span class="subtitles">{{"SYSTEM.READONLY.INSTALLATIONDATE" | translate}}: </span>
            <p class="content">{{systemInfo.stepFour.product_installdate}}</p>
        </div>
        <div class="col-6 col-md-4 col-lg-3">
            <span class="subtitles">{{"SYSTEM.READONLY.SYSCOMPOSITION" | translate}}: </span>
            <p class="content">{{systemInfo.stepFour.product_systemcomposition}}</p>
        </div>
        <div class="col-6 col-md-4 col-lg-3">
            <span class="subtitles">{{"SYSTEM.READONLY.WECOCOMPONENTS" | translate}}: </span>
            <p class="content">{{systemInfo.stepFour.product_systemweco}}</p>
        </div>
        <div class="col-6 col-md-4 col-lg-3">
            <span class="subtitles">{{"SYSTEM.READONLY.OTHERBRAND" | translate}}: </span>
            <p class="content">{{systemInfo.stepFour.product_brand}}</p>
        </div>
    </div>

    <div class="row">
        <div class="col-12 mb-3 title">
            {{"SYSTEM.READONLY.INVERTERINFO" | translate}}
        </div>
    </div>
    <div class="row">
        <div class="col-6 col-md-4 col-lg-3">
            <span class="subtitles">{{"SYSTEM.READONLY.HYBRID" | translate}}: </span>
            <p class="content">{{systemInfo.inverter.inverter_hybrid? "Yes" : "No"}}</p>
        </div>
        <div class="col-6 col-md-4 col-lg-3">
            <span class="subtitles">{{"SYSTEM.READONLY.ONLINE" | translate}}: </span>
            <p class="content">{{systemInfo.inverter.inverter_online? "Yes" : "No"}}</p>
        </div>
        <div class="col-6 col-md-4 col-lg-3">
            <span class="subtitles">{{"SYSTEM.READONLY.INVERTERSNUMBER" | translate}}: </span>
            <p class="content">{{systemInfo.inverter.inverter_number}}</p>
        </div>
        <div *ngIf="systemInfo.inverter.inverter_number! > 1" class="col-6 col-md-4 col-lg-3">
            <span class="subtitles">{{"SYSTEM.READONLY.PARALLELPOWER" | translate}}: </span>
            <p class="content">{{systemInfo.inverter.inverter_communication? "Yes" : "No"}}</p>
        </div>
        <div *ngIf="systemInfo.inverter.inverter_number! > 1" class="col-12 col-sm-6 col-md-4 col-lg-3">
            <span class="subtitles">{{"SYSTEM.READONLY.PARALLELCOMUNICATION" | translate}}: </span>
            <p class="content">{{systemInfo.inverter.inverter_communication? "Yes" : "No"}}</p>
        </div>
        <div *ngIf="systemInfo.inverter.inverter_number! > 1" class="col-lg-8 d-none d-sm-inline"></div>
        <div *ngIf="systemInfo.inverter.inverter_number! <= 1" class="col-sm-6 col-lg-3 d-none d-md-none d-lg-inline d-sm-inline"></div>
        <div *ngFor="let inverter of systemInfo.inverter.inverters_list; let i = index"
            class="col mt-4 text-center d-flex justify-content-center">
            <div class="card" style="min-width: 250px;">
                <div class="card-header" style="font-weight: bold;">
                    {{"SYSTEM.READONLY.INVERTER" | translate}} n. {{i+1}}
                </div>
                <div class="card-body">
                    <span class="subtitles">{{"SYSTEM.READONLY.MODEL" | translate}}</span><br>
                    <span>{{inverter.model}}</span><br>
                    <span class="subtitles">{{"SYSTEM.READONLY.SERIALNUMBER" | translate}}</span><br>
                    <span>{{inverter.serialnumber}}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-12 mb-3 title">
            {{"SYSTEM.READONLY.CLUSTERINFO" | translate}}
        </div>
    </div>
    <div class="row">
        <div class="col-6 col-lg-3">
            <span class="subtitles">{{"SYSTEM.READONLY.VOLTAGE" | translate}}: </span>
            <p class="content">{{systemInfo.cluster.refidwecaresystemvolt}}</p>
        </div>
        <div class="col-6 col-lg-3">
            <span class="subtitles">{{"SYSTEM.READONLY.MODEL" | translate}}: </span>
            <p class="content">{{systemInfo.cluster.system_model}}</p>
        </div>
        <div class="col-6 col-lg-3">
            <span class="subtitles">{{"SYSTEM.READONLY.TYPE" | translate}}: </span>
            <p class="content">{{systemInfo.cluster.refidwecaresystemtype}}</p>
        </div>
        <div class="col-6 col-lg-3">
            <span class="subtitles">{{"SYSTEM.READONLY.SINGLECLUSTER" | translate}}: </span>
            <p class="content">{{systemInfo.cluster.cluster_singlebattery? "Yes" : "No"}}</p>
        </div>
        <div *ngIf="systemInfo.cluster.cluster_singlebattery! == 0" class="col-6 col-lg-3">
            <span class="subtitles">{{"SYSTEM.READONLY.PARALLELCLUSTERS" | translate}}: </span>
            <p class="content">{{systemInfo.inverter.inverter_communication? "Yes" : "No"}}</p>
        </div>
        <div *ngIf="systemInfo.cluster.cluster_singlebattery! == 0" class="col-6 col-lg-3">
            <span class="subtitles">{{"SYSTEM.READONLY.CLUSTERNUMBER" | translate}}: </span>
            <p class="content">{{systemInfo.cluster.cluster_number}}</p>
        </div>
        <div *ngIf="systemInfo.cluster.cluster_singlebattery! == 0" class="col-12 col-lg-3">
            <span class="subtitles">{{"SYSTEM.READONLY.DEVICESFORCLUSTER" | translate}}: </span>
            <p class="content">{{systemInfo.cluster.cluster_numberdevices}}</p>
        </div>
        <div class="col-lg-3 d-none d-lg-inline"></div>
        <div *ngFor="let cluster of systemInfo.cluster.clusters_list; let i = index"
            class="col text-center d-flex justify-content-center mt-4">
            <div class="card" style="min-width: 250px;">
                <div class="card-header" style="font-weight: bold;">
                    {{cluster.name}}
                </div>
                <div class="card-body">
                    <div *ngFor="let slave of cluster.batteries; let y = index" style="border-bottom: 1px solid lightgray;">
                        <span *ngIf="y == 0;" style="font-weight: bold;">{{"SYSTEM.READONLY.MASTER" | translate}}<br></span>
                        <span *ngIf="y > 0" style="font-weight: bold;">{{"SYSTEM.READONLY.SLAVE" | translate}} {{y}}<br></span>
                        <span>{{slave.serialnumber}}</span><br>
                    </div><br>
                    <span class="subtitles mt-2">{{"SYSTEM.READONLY.RELATEDINVERTER" | translate}}</span><br>
                    <div *ngFor="let inverter of cluster.inverters">
                        {{inverter.serialnumber}},
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <img [src]="urlServerLara + modalImageUrl" class="img-fluid">
            </div>
        </div>
    </div>
</div>

<ng-template #blockError class="mt-4 p-2 text-center">
    <h1>{{"SYSTEM.READONLY.LOADINGERROR" | translate}}</h1><br>
    <h3 class="mt-4">{{"SYSTEM.READONLY.REFRESH" | translate}}</h3>
</ng-template>